function getCurrentDate(){var t=new Date,e=t.getDate(),o=t.getMonth()+1,a=t.getFullYear();e<10&&(e="0"+e),o<10&&(o="0"+o);var t=e+"/"+o+"/"+a;return t}function generateUUID(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?o:3&o|8).toString(16)});return e}function randomFour(){var t=Math.floor(1e3+9e3*Math.random());return t}function slugify(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}var config={apiKey:"AIzaSyBuddga2i4I97hq18krbZ5EhTehY_EBy1Q",authDomain:"usable-post.firebaseapp.com",databaseURL:"https://usable-post.firebaseio.com",storageBucket:"usable-post.appspot.com"};firebase.initializeApp(config);var db={jobs:firebase.database().ref("jobs")},auth=firebase.auth(),postList={template:"#postList",data:function(){return{jobs:[]}},watch:{$route:"fetchData"},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;db.jobs.once("value",function(e){e.forEach(function(e){var o=e.val();t.jobs.push(o)})})}}},newJob={template:"#addJob",data:function(){return{jobs:{}}},methods:{save:function(){var t=getCurrentDate();this.jobs.slug=generateUUID(),this.jobs.slugifiedTitle=slugify(this.jobs.title),this.jobs.slugifiedCompanyName=slugify(this.jobs.companyName);var e=randomFour();db.jobs.child(this.jobs.slug).set({title:this.jobs.title,location:this.jobs.location,type:this.jobs.type,description:this.jobs.description,salary:this.jobs.salary,applicationMethod:this.jobs.applicationMethod,companyName:this.jobs.companyName,companyWebsite:this.jobs.companyWebsite,adminContactName:this.jobs.adminContactName,adminContactEmail:this.jobs.adminContactEmail,approved:!1,key:this.jobs.slug,slug:e+"-"+this.jobs.slugifiedTitle+"-"+this.jobs.slugifiedCompanyName,timestamp:t}),this.$router.push("/")}}},viewJob={template:"#singleJob",data:function(){return{jobs:[]}},watch:{$route:"fetchData"},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;db.jobs.child(this.$route.params.slug).once("value",function(e){null===e.val()?router.push("/404"):t.jobs=e.val()})}}},editJob={template:"#addJob",data:function(){return{jobs:[]}},beforeRouteEnter:function(t,e,o){localStorage.token?o():o({path:"/login"})},watch:{$route:"fetchData"},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;db.jobs.child(this.$route.params.slug).once("value",function(e){null===e.val()?router.push("/404"):t.jobs=e.val()})},save:function(){this.jobs.slugifiedTitle=slugify(this.jobs.title),this.jobs.slugifiedCompanyName=slugify(this.jobs.companyName),db.jobs.child(this.$route.params.slug).update({title:this.jobs.title,location:this.jobs.location,type:this.jobs.type,description:this.jobs.description,salary:this.jobs.salary,applicationMethod:this.jobs.applicationMethod,companyName:this.jobs.companyName,companyWebsite:this.jobs.companyWebsite,adminContactName:this.jobs.adminContactName,adminContactEmail:this.jobs.adminContactEmail,approved:this.jobs.approved}),this.$router.push("/admin")}}},adminHome={template:"#adminHome",data:function(){return{jobs:[],authenticated:!1}},beforeRouteEnter:function(t,e,o){localStorage.token?o():o({path:"/login"})},watch:{$route:"fetchData"},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;db.jobs.once("value",function(e){e.forEach(function(e){var o=e.val();t.jobs.push(o)})}),localStorage.token&&(t.authenticated=!0)},logout:function(){auth.signOut().then(function(){localStorage.removeItem("token"),router.push("/login")},function(t){})}}},notFound={template:"#NotFound"},loginScreen={template:"#loginScreen",data:function(){return{login:{},authenticated:!1,isProcessing:!1,errorMessage:!1}},methods:{login:function(){this.isProcessing=!0,auth.signInWithEmailAndPassword(this.login.email,this.login.password).then(function(t){localStorage.token=t.uid,this.authenticated=!0,router.push("/admin")}).catch(function(t){})}}},router=new VueRouter({routes:[{name:"home",path:"/",component:postList},{name:"newJob",path:"/add-job",component:newJob},{name:"viewJob",path:"/posts/:slug",component:viewJob},{name:"adminHome",path:"/admin",component:adminHome},{name:"editJob",path:"/admin/posts/:slug",component:editJob},{name:"loginScreen",path:"/login",component:loginScreen},{name:"404",path:"/404",component:notFound}]}),app=new Vue({router:router}).$mount("#app");